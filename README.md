# 同化棋AI设计

## 1. 项目简介

* 这是一个基于C++实现的同化棋（Assimilation Chess）人工智能项目，作为我的数据结构课程设计。本项目旨在运用数据结构和算法知识，设计一个能够与人类玩家对抗的AI

## 2. 游戏规则

* 游戏规则：
* 这里的同化棋游戏与国际通行的同化棋规则基本一致。
* 同化棋是一种二人棋盘游戏，黑白双方交替在7x7的棋盘上移动棋子。
* 玩家每次可以移动的位置是有限的，具体步骤解释如下：
●选取现在在棋盘上己方的一枚棋子，再选择一个落子位置。要求落子处为空，既没有对方也没有己方的棋子。
●选择的落子位置可以是以下二者之一：
* 1.落子位置在以选取的棋子为中心的3x3的范围内。此时选取的棋子会复制自身到落子位置。一共有8个位置可以选择。
* 2.落子位置在以选取的棋子为中心的3x3的范围外、5x5的范围内，此时选取的棋子会移动自身到落子位置，一共有16个位置可以选择。 ●总的来说，移动一格是“复制粘贴”,移动两格是“剪切粘贴”。
* 每次落子后，新位置的落子会将落子处紧邻的8个位置的棋子(如果有)都变成自己的棋子。
* 若没有上述这种位置则游戏结束，将所有无子的地方算作有子可下一方的棋子，然后数出双方棋子数，棋多者胜。
* 任意时刻对方棋子数为0时，己方胜利。
* 新规则：如果局面发生循环，即有一方的一步使得局面回到了曾经出现过的一个局面，那么对方将不能走出和当时一样的一步。否则会被判为不合法输入。游戏回合数到400时，游戏会直接结束，数出双方棋子数，棋多者胜。
* 棋盘初始状态为：主对角线两端各有1黑子，副对角线两端则为白子
* 黑方为先手。
* 鉴于平台时间限制，每步要在1秒内完成。

## 3. 特性与功能

*   支持人机对战模式。
*   AI采用 Minimax算法 进行决策。
*   引入了Alpha-Beta剪枝优化，提高了搜索效率。
*   综合考虑中心控制，边角控制，潜在翻转等等因素，利用杀手启发(killer-move)和历史启发等启发评估函数
*  采用位棋盘加快运算，提供更多决策时间


## 4. 技术栈

*   **编程语言:** C++
*   **开发环境:** Visual Studio Code
*   **数据结构:** 数组, 哈希表等等
*   **核心算法:** Minimax, Alpha-Beta剪枝等

## 5. 如何编译和运行

* 由于最后在botzone平台提交，因此最后采取的是简单交互的形式


## 6. AI设计与算法分析

* 核心算法：
	核心算法基于Alpha-Beta剪枝的博弈树搜索，结合迭代加深和时间控制。使用7×7二维数组表示棋盘状态，通过置换表缓存历史局面结果，并采用Zobrist哈希快速比对棋盘状态。策略上设计多阶段评估函数，根据棋局阶段动态调整权重，并应用杀手启发和历史启发加速搜索。
* 游戏逻辑与状态表示：
	棋盘表示使用gridInfo[7][7]存储棋盘状态（0=空，1=黑棋，-1=白棋）。全局变量blackPieceCount和whitePieceCount实时统计棋子数。移动规则通过delta[24][2]定义24种方向（8邻域+16跳跃）。翻转敌方棋子在落子后检查8邻域，翻转相邻敌方棋子（ProcStep函数实现）。合法移动生成由getValidMoves遍历所有己方棋子，生成可达的空位列表。
* 搜索算法：
	Alpha-Beta剪枝通过递归搜索从当前局面出发，模拟双方落子，交替最大化/最小化评分。剪枝条件为alpha（当前玩家能保证的最高分）和beta（对手能接受的最低分），当alpha >= beta时停止搜索后续分支。迭代加深逐步增加搜索深度（depth=1 → MAX_DEPTH），每次迭代调用alphaBeta函数。超时终止在每次深度增加前检查时间，确保在980ms内返回结果。

## 7. 挑战与改进思路

* 1)搜索算法优化：尝试更高级的剪枝策略（如Null Move Pruning）或并行搜索；加入主要变量搜索（PVS）加速搜索，减少冗余计算，提高决策准确率；已经观察到剪枝在后期可能会出现决策失误的情况但前期的决策较准确，而MCTS算法及其延伸算法在前期由于模拟数据不够导致决策较差，可以采用混合树搜索（Hybrid Tree Search），结合UCT算法，兼容两者的优点进行决策。
* 2)动态对手模型识别：根据观察结果，大多数的决策模型集中在暴力贪心或二步贪心、Alpha-beta剪枝优化的Minmax搜索或者MCTS算法及其延伸，可以考虑在前期下棋时只记录对手的棋盘，根据三种决策模型各自的特点尝试猜测对手的决策模型，据此调整自身的决策和评估参数，以适应对手的进攻节奏。
* 3)结合简单的机器学习做出决策引导：引入3层左右的小型MLP模型，在PyTorch里离线训练，作为自身决策的前向引导，可以在极短的时间内辅助自身做出更好的决策。
* 4)引入更复杂的位棋盘和权重表(PST)：位棋盘负责“怎么快”，PST负责“评得准”，两者结合可以给AI提供更好的决策建议，在加速的同时节省更多时间来进行决策，同时提高决策的准确率

## 8. 贡献与致谢

*   感谢朱老师以及他辛苦的工作。
*  参考文献：
* (1)黑白棋AI设计探究_黄海同
* (2)计算机博弈算法在黑白棋中的应用_彭之军
* (3)蒙特卡洛树搜索实验设计——以黑白棋为例_张宇辉
* (4)全局求解Minimax线性规划的分支定界算法（英文）_王慧满
* (5)面向蒙特卡洛树搜索算法的深度神经网络的设计与实现_明红兵
* (6)Accelerating Deep Neural Net work guided MCTS using Adaptive Parallelism
* (7)几种智能算法在黑白棋程序中的应用_柏爱俊0511@USTC
* (8)https://blog.csdn.net/caozixuan98724/article/details/10321375
* (9)https://blog.csdn.net/weixin_42165981/article/details/103263211
* (10)https://oi-wiki.org/search/alpha-beta/
